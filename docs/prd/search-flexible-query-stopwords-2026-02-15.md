# PRD: 검색어 라벨 토큰(담당자/작성자 등) 처리 및 후보 선정 유연화 (2026-02-15)

## 문제
- 글로벌 검색에서 사용자가 `담당자 이용호`, `작성자 이용호`처럼 **라벨+값** 형태로 검색하면 0건으로 나오는 경우가 있다.
- 원인
  - (프로젝트) 검색 후보를 DB에서 뽑는 프리필터가 `manager_name(담당자)`/`equipment_names(설비명)`처럼 **조인/파생 필드**를 고려하지 않는다.
  - (프로젝트/안건) 점수 계산에서 다중 토큰 쿼리의 “최소 매칭 토큰 수” 규칙 때문에 `담당자`, `작성자` 같은 라벨 토큰이 포함되면 매칭이 과도하게 엄격해진다.

## 목표
1. `담당자 이용호` 같은 검색어에서도 프로젝트 검색 결과가 나오도록 한다.
2. `작성자 이용호` 같은 검색어에서도 안건 검색 결과가 나오도록 한다.
3. 기존의 “다중 토큰은 최소 2개 이상 매칭” 품질 규칙은 유지하되, 라벨 토큰이 방해하지 않도록 한다.

## 요구사항
### BE-REQ
- BE-REQ-001: 프로젝트 검색 토크나이저가 라벨성 토큰(예: `담당자`, `고객사`, `프로젝트코드`)을 보조 토큰으로 취급(필요 시 제거)해야 한다.
- BE-REQ-002: `GET /budget/projects/search`의 후보 선정 단계가 `manager_user_id(User.full_name/email)`와 `BudgetEquipment.equipment_name(현재 버전)`도 포함하도록 확장되어야 한다.
- BE-REQ-003: 안건 검색 토크나이저가 라벨성 토큰(예: `작성자`, `요청자`, `응답자`)을 보조 토큰으로 취급(필요 시 제거)해야 한다.
- BE-REQ-004: `GET /agenda/threads/search`의 후보 선정 단계가 `AgendaThread.created_by_user_id(User.full_name/email)` 및 `AgendaEntry(title/content_plain)` 기반 후보도 포함해야 한다.

### FE-REQ
- FE-REQ-001: 프론트는 기존과 동일하게 `q`를 서버에 전달하되, 서버 개선으로 결과가 “유연하게” 나오도록 한다(프론트 변경 최소화).

## 수용 기준(AC)
1. (프로젝트) `담당자 이용호`로 검색 시 `manager_name=이용호`인 프로젝트가 1개 이상 반환된다.
2. (안건) `작성자 이용호`로 검색 시 `created_by_user_id`가 `이용호`인 안건이 1개 이상 반환된다.
3. `npm run verify:fast`가 통과한다.

