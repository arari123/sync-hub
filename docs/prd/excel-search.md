# PRD: Excel 문서 검색 지원

## 1. 목적
PDF 중심 검색 범위를 Excel 문서(`.xlsx`)까지 확장하여, 보고서/작업일지 형태의 정형 문서도 동일 검색 파이프라인에서 조회 가능하게 한다.

## 2. 핵심 기능

### EX-REQ-001: 업로드 확장
- [AC-1] `POST /documents/upload`에서 Excel 문서(`.xlsx`) 업로드를 허용한다.
- [AC-2] 기존 PDF 업로드/처리 동작에 회귀가 없어야 한다.

### EX-REQ-002: Excel 파싱/인덱싱
- [AC-1] 시트별 텍스트를 추출해 인덱싱 가능한 세그먼트로 변환한다.
- [AC-2] 셀 테이블 구조를 보존할 수 있도록 `table_raw`, `table_row_sentence` 청크를 생성한다.
- [AC-3] 시트 단위 식별이 가능하도록 검색 결과의 `page` 필드에 시트 순번(1-base)을 저장한다.

### EX-REQ-003: 검색 및 UI
- [AC-1] Excel 문서 업로드 후 `/documents/search`에서 키워드로 검색 가능해야 한다.
- [AC-2] 프론트 업로드 위젯에서 PDF/Excel 파일을 선택할 수 있어야 한다.

### EX-REQ-004: 테스트 데이터 및 검증
- [AC-1] 고객사/작성자/작업장소/대상설비/고객사 담당자/작업 일자/작업 시간/작업 내용을 포함한 테스트용 Excel 보고서 10개를 생성한다.
- [AC-2] 양식은 서로 다르게 구성해 비정형/반정형 입력을 함께 검증한다.
- [AC-3] 생성된 문서를 실제 업로드/검색 테스트에 사용하고 결과를 기록한다.

## 3. 제약 사항
- 개발/실행/검증은 Docker 컨테이너 기준으로 수행한다.
- 테스트 샘플은 재현 가능해야 하며 파일명 규칙을 유지한다.
