# PRD: AS 프로젝트 종속/일정 간소화 (2026-02-15)

## 배경
현재 `AS` 프로젝트가 설비 프로젝트와 독립적으로 생성/운영되어, 같은 설비에 대한 이력(예산/안건/자료/일정)을 한 흐름으로 보기 어렵다. 또한 AS 프로젝트는 별도의 일정 입력이 필요 없는데도, 일반 프로젝트와 동일한 일정 UI(WBS)를 요구해 사용성이 떨어진다.

용어 정리:
- `AS`는 **프로젝트 종류(project_type)** 를 의미한다.
- `워런티`는 **설비 프로젝트 일정 단계(설계-제작-설치-워런티)** 를 의미한다.

## 목표
1. `AS` 프로젝트는 반드시 **설비(equipment) 프로젝트에 종속**되도록 한다.
2. AS 프로젝트 생성 시 **소속 설비 프로젝트 선택**을 필수로 한다.
3. 메인(`/home`) 프로젝트 리스트 및 프로젝트 메인 페이지에서 AS 프로젝트는 **소속 설비 프로젝트를 작게 표시**한다(리스트 패널 크기 유지).
4. AS 프로젝트의 일정 표시는 **시작-종료 2단계**로 간소화하고, 별도 일정 입력을 요구하지 않는다.
   - 메인(`/home`) 리스트의 일정 영역
   - 프로젝트 메인 페이지의 일정 마일스톤 영역
5. AS 프로젝트 메인 페이지의 정보 패널에 **소속 설비 프로젝트**를 표시한다.
6. 기존에 저장된 AS 프로젝트 데이터도 종속 구조에 맞게 마이그레이션한다.

## 비목표
- 설비 프로젝트에 AS 프로젝트 목록(자식 리스트)을 별도 패널로 신설하지 않는다.
- AS 프로젝트의 예산/버전/안건 구조 자체는 변경하지 않는다.

## 요구사항
### DB/BE-REQ
- BE-REQ-001: `budget_projects`에 `parent_project_id`(nullable) 컬럼을 추가한다.
- BE-REQ-002: `project_type=as` 프로젝트는 `parent_project_id`가 반드시 존재해야 하며, 대상은 `project_type=equipment` 프로젝트여야 한다.
- BE-REQ-003: 프로젝트 직렬화 응답에는 `parent_project_id`와 `parent_project`(id/name/code) 정보를 포함한다.
- BE-REQ-004: AS 프로젝트는 일정 입력이 필요 없으므로 `PUT /budget/projects/{project_id}/schedule`은 AS 프로젝트에 대해 거부(400)한다.
- BE-REQ-005: 기존 AS 프로젝트 데이터는 마이그레이션하여 `parent_project_id`를 설정한다(기존 데이터 보존).

### FE-REQ
- FE-REQ-001: 프로젝트 생성 화면에서 `project_type=as`일 때 소속 설비 프로젝트 선택 UI를 제공하고, 선택 없이는 생성할 수 없다.
- FE-REQ-002: 프로젝트 정보 수정 화면에서 `project_type=as`일 때 소속 설비 프로젝트를 변경할 수 있다(필수).
- FE-REQ-003: 메인(`/home`) 프로젝트 카드에서 AS 프로젝트는 소속 설비 프로젝트를 작은 배지/텍스트로 표시한다(카드 크기 유지).
- FE-REQ-004: 메인(`/home`) 프로젝트 카드의 일정 영역에서 AS 프로젝트는 **시작/종료 2단계**만 표시한다.
- FE-REQ-005: 프로젝트 메인 페이지의 일정 마일스톤에서 AS 프로젝트는 **시작/종료 2단계**만 표시한다(기존 마일스톤 디자인 유지).
- FE-REQ-006: 프로젝트 메인 페이지의 정보 패널에 AS 프로젝트의 소속 설비 프로젝트를 표시한다.

## 수용 기준(AC)
1. AS 프로젝트 생성 시 소속 설비 프로젝트 선택이 필수이며, 미선택 시 생성이 실패한다.
2. `/home` 프로젝트 리스트에서 AS 프로젝트 카드에 소속 설비 프로젝트가 표시된다.
3. `/home` 프로젝트 리스트의 일정 영역에서 AS 프로젝트는 시작/종료만 표시된다.
4. 프로젝트 메인 페이지의 일정 마일스톤에서 AS 프로젝트는 시작/종료만 표시된다.
5. 프로젝트 메인 페이지 정보 패널에 소속 설비 프로젝트가 표시된다.
6. 기존 AS 프로젝트 데이터가 마이그레이션되어 `parent_project_id`가 채워진다.
7. `docker exec -w /app synchub_web bash scripts/verify_fast.sh`가 통과한다.
8. `docker exec -w /app synchub_frontend npm run build`가 통과한다.
