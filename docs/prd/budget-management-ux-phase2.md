# PRD: 예산 입력 UX 고도화 (Phase 2)

## 1. 목적
- 예산 입력의 실사용 효율을 높이기 위해 재료비/인건비/경비 입력 UX와 자동 계산 규칙을 고도화한다.
- 프로젝트 모니터링/상세에서 사용하는 비용 집계 정확도를 유지하면서 입력 시간을 단축한다.

## 2. 범위
- 포함
  - 재료비: 엑셀형 입력 UX(키보드 이동, 붙여넣기, 정렬, 자동완성)
  - 인건비: 기본 부서 항목/인원 기반 입력, 단위(H/D/W/M) 환산
  - 경비: 자동 산정 + 사용자 수정 가능 구조
  - 우측 사이드바: 현재 입력 내역 요약(재료/인건/경비, 제작/설치)
  - 단일/복수 설비 프로젝트 입력 UX 분기
- 제외
  - 완전한 스프레드시트 엔진 수준의 드래그 복제/다중 셀 범위 연산 전체
  - 결재/승인 워크플로우

## 3. 핵심 요구사항

### BM-UX2-REQ-001: 공통 구조
- [AC-1] 예산 항목은 `재료비`, `인건비`, `경비`로 구성한다.
- [AC-2] 모든 항목은 `제작`, `설치` 축으로 집계된다.
- [AC-3] 복수 설비 프로젝트는 설비 구분 입력을 유지한다.
- [AC-4] 단일 설비 프로젝트는 설비 구분 입력 부담을 최소화한다.

### BM-UX2-REQ-002: 재료비 입력
- [AC-1] 재료비는 `설비 > 유닛 > 파츠` 계층을 유지한다.
- [AC-2] 파츠 입력 컬럼은 `파츠명`, `모델명`, `수량`, `단가`, `합계`를 지원한다.
- [AC-3] 수량*단가로 합계가 즉시 계산된다.
- [AC-4] 설비/유닛은 자동완성 입력을 제공한다.
- [AC-5] 헤더 클릭으로 문자/수치 정렬(오름차순/내림차순)을 지원한다.

### BM-UX2-REQ-003: 인건비 입력
- [AC-1] 기본 항목은 `PM`, `설계`, `SW`, `검사기술`, `제어1`, `제어2`를 제공한다.
- [AC-2] 기본 항목은 설정에서 변경 가능하다.
- [AC-3] 부서별 인원(최소 1, 최대 n)을 입력할 수 있다.
- [AC-4] 금액은 `인원 * 시간(환산) * 단가`로 자동 계산된다.
- [AC-5] 시간 단위는 `H`, `D`, `W`, `M`를 지원한다.
- [AC-6] 환산 기준:
  - `D = 8H`
  - `W = 국내 5D / 해외 7D`
  - `M = 국내 22D / 해외 30D`

### BM-UX2-REQ-004: 경비 자동 산정
- [AC-1] 기본 경비 항목:
  - 프로젝트 운영비, 소모품비, 공구비, 출장비, 숙박비, 국내 교통비, 해외 교통비, 항공료, 현지인원채용 비용, 도비 비용, 기타 비용
- [AC-2] 경비는 재료비/인건비 및 설치 조건으로 자동 산정된다.
- [AC-3] 자동 산정 후 사용자가 금액을 수정할 수 있다.
- [AC-4] 설치 장소(국내/해외)에 따라 산식이 달라진다.

### BM-UX2-REQ-005: 우측 요약 사이드바
- [AC-1] 재료비는 제작/설치 총합과 설비/유닛 합계를 표시한다.
- [AC-2] 인건비/경비는 제작/설치 총합을 표시한다.
- [AC-3] 현재 입력 모드(예산/집행)에 맞는 수치를 표시한다.

## 4. 데이터 확장(현재 구조 호환)
- `budget_detail_json`에 기존 키와 함께 아래 메타를 저장 가능해야 한다.
  - `budget_settings`: 인건비 기본부서, 환산/비율/국가단가 설정
  - 각 row 확장 필드: `headcount`, `location_type`, `is_auto`, `auto_formula`

## 5. 구현 우선순위
1. Phase 2-1: 데이터/계산 확장 + 입력화면 핵심 UX(정렬, 자동완성, 인건비 인원/단위, 경비 자동산정, 사이드바 확장)
2. Phase 2-2: 고급 엑셀 상호작용(다중선택, 드래그 자동복제, 단축키 확장)
3. Phase 2-3: 설정 UI 고도화(관리자 설정 페이지 분리, 국가별 템플릿 관리)

