# PRD: 호스팅 문서 검색 폴백 도입 (2026-02-19)

## 배경
호스팅 환경에서 Elasticsearch가 비활성(`memory` 모드)인 상태에서 인스턴스 재시작이 발생하면 메모리 인덱스가 초기화되어, 업로드가 완료된 문서도 일반 검색 결과가 0건으로 반환되는 문제가 발생한다.

## 문제
- `/documents/search`가 벡터스토어 인덱스 결과에만 의존한다.
- 인덱스 미존재/초기화 상태에서는 DB에 `completed` 문서가 있어도 검색 불가.
- 데이터 허브 AI(`/api/data-hub/ask`)도 동일하게 근거 수집 실패(`rag_no_context`)로 이어진다.

## 요구사항
1. 벡터스토어 검색 결과가 비어 있을 때 DB 기반 텍스트 검색 폴백을 수행한다.
2. 폴백 결과는 기존 검색 응답 스키마(`items/page/page_size/total`)를 유지한다.
3. 데이터 허브 AI의 근거 수집도 동일 폴백 히트를 사용할 수 있어야 한다.
4. 기존 로컬/ES 정상 경로는 유지한다.

## 완료 기준
- 호스팅에서 기존 `completed` 문서가 일반 검색으로 조회된다.
- 동일 문서 질의 시 데이터 허브 AI 답변(`rag_answer`)이 생성된다.
